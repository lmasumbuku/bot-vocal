import requests

@app.route("/transcription", methods=['POST'])
def transcription():
    """ RÃ©cupÃ¨re l'audio et l'envoie Ã  OpenAI pour transcription """
    audio_url = request.form.get("RecordingUrl", "")

    print(f"ğŸ™ï¸ URL de l'enregistrement reÃ§u : {audio_url}")

    if not audio_url:
        print("âŒ Aucun enregistrement reÃ§u !")
        return "Erreur : Aucun enregistrement reÃ§u."

    # ğŸ“¥ TÃ©lÃ©charger l'audio
    transcribed_text = transcrire_avec_openai(audio_url)

    print(f"âœ… Transcription OpenAI : {transcribed_text}")

    response = VoiceResponse()
    response.say(f"Vous avez commandÃ© : {transcribed_text}. Merci pour votre commande !", 
                 voice='alice', language='fr-FR')

    return str(response)
